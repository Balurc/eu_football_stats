version: 2

models:
  - name: dim_leagues
    description: >
      List of European football leagues identified each identified by a league id.
    columns:
      - name: league_id
        description: "Unique identifier of the league."
        meta:
          dimension:
            type: string
            label: "League ID"
        tests:
          - relationships:
              to: ref('dim_teams', 'dim_results')
              field: league_id
      - name: league_name
        description: "League name."
        meta:
          dimension:
            type: string
            label: "League Name"

  - name: dim_results
    description: >
      List of matches identified by match_id
      Contains match information from 10 seasons of English Premier League with detailed information on the team names, seasons, half-time and full-time results.
    columns:
      - name: match_id
        description: "Unique identifier for ever match."
        meta:
          dimension:
            type: string
            label: "Match ID"
      - name: league_id
        description: "Unique identifier of the league."
        meta:
          dimension:
            type: string
            label: "League ID"
      - name: season
        description: "Period or season of the league."
        meta:
          dimension:
            type: string
            label: "Season"
      - name: hometeam_id
        description: "Unique identifier for home team."
        meta:
          dimension:
            type: string
            label: "Hometeam ID"
        tests:
          - relationships:
              to: ref('dim_teams')
              field: team_id
      - name: awayteam_id
        description: "Unique identifier for away team."
        meta:
          dimension:
            type: string
            label: "Awayteam ID"
        tests:
          - relationships:
              to: ref('dim_teams')
              field: team_id
      - name: full_time_result
        description: "Full time result - H; Home Wins, D; Draw & A; Away Wins"
        meta:
          dimension:
            type: string
            label: "Fulltime Result"
      - name: half_time_result
        description: "Half time result - H; Home Wins, D; Draw & A; Away Wins"
        meta:
          dimension:
            type: string
            label: "Halftime Result"

  - name: dim_teams
    description: >
      List of teams identified team_id and team_name.
    columns:
      - name: team_id
        description: "Unique identifier for every team in the league."
        meta:
          dimension:
            type: string
            label: "Team ID"
      - name: team_name
        description: "Team name."
        meta:
          dimension:
            type: string
            label: "Team Name"
      - name: league_id
        description: "Unique identifier of the league."
        meta:
          dimension:
            type: string
            label: "League ID"
      

  - name: fact_stats
    description: "{{ doc('fact_stats') }}"
    columns:
      - name: league_id
        tests:
          - relationships:
              to: ref('dim_leagues')
              field: league_id
      - name: match_id
        tests:
          - relationships:
              to: ref('dim_results')
              field: match_id
      - name: hometeam_id
        tests:
          - relationships:
              to: ref('dim_teams')
              field: team_id
      - name: awayteam_id
        tests:
          - relationships:
              to: ref('dim_teams')
              field: team_id
    
  - name: league_standings
    description: >
      Table that contains every team wins, draws and loses for every match they played in, home and away.
    columns:
      - name: league_name
        description: "League name."
        meta:
          dimension:
            label: 'League Name'
      - name: season
        description: "Period or season of the league."
        meta:
          dimension:
            label: 'Season'
      - name: team_name
        description: "Team name."
        meta:
          dimension:
            label: 'Team Name'
          metrics:
            total_matches:
              type: count
              label: "MP"
      - name: status
        description: "Home or away status."
        meta:
          dimension:
            label: 'Status'
      - name: wins
        description: "Number of wins."
        meta:
          dimension:
            label: 'Wins'
          metrics:
            total_wins:
              type: sum
              label: "W"
      - name: draws
        description: "Number of draws."
        meta:
          dimension:
            label: 'Draws'
          metrics:
            total_draws:
              type: sum
              label: "D"
      - name: loses
        description: "Number of loses."
        meta:
          dimension:
            label: 'Loses'
          metrics:
            total_loses:
              type: sum
              label: "L"
      - name: goals_for
        description: "Number of goals the team has scored."
        meta:
          dimension:
            label: 'Goal Scored'
          metrics:
            total_gf:
              type: sum
              label: "GF"
      - name: goals_against
        description: "Number of goals the team has conceded."
        meta:
          dimension:
            label: 'Goals Conceded'
          metrics:
            total_ga:
              type: sum
              label: "GA"
      - name: goals_difference
        description: "Number of goals difference between goals scored and conceded."
        meta:
          dimension:
            label: 'Goals Difference'
          metrics:
            total_gd:
              type: sum
              label: "GD"
      - name: points
        description: "Points received."
        meta:
          dimension:
            label: 'Points'
          metrics:
            total_points:
              type: sum
              label: "Points"

  - name: fact_league_stats
    description: >
      Table that contains every team in-game statistics for every match they played, home and away.
    columns:
      - name: season
        description: "Period or season of the match."
        meta:
          dimension:
            label: 'Season'
      - name: league_name
        description: "League name."
        meta:
          dimension:
            label: 'League Name'
      - name: match_id
        description: "Unique identifier for a match."
        meta:
          dimension:
            label: 'Match ID'
      - name: total_goals
        description: "Total goals scored."
        meta:
          dimension:
            label: 'Total Goals'
          metrics:
            total_goals:
              type: sum
              labels: "Goals"
      - name: total_shots
        description: "Total number of shots made."
        meta:
          dimension:
            label: 'Total Shots'
          metrics:
            total_shots:
              type: sum
              labels: "Shots"
      - name: total_shots_on_target
        description: "Total number of shots on target made."
        meta:
          dimension:
            label: 'Total Shots On Target'
          metrics:
            total_shots_on_target:
              type: sum
              labels: "Shots On Target"
      - name: total_fouls_commited
        description: "Total number of fouls commited."
        meta:
          dimension:
            label: 'Total Fouls'
          metrics:
            total_fouls_commited:
              type: sum
              labels: "Fouls"
      - name: total_yellow_cards
        description: "Total number of yellow cards received."
        meta:
          dimension:
            label: 'Total Yellow Cards'
          metrics:
            total_yellow_cards:
              type: sum
              labels: "Yellow Cards"
      - name: total_red_cards
        description: "Total number of red cards received."
        meta:
          dimension:
            label: 'Total Red Cards'
          metrics:
            total_red_cards:
              type: sum
              labels: "Red Cards"